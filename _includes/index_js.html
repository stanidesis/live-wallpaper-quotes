<script type="text/javascript">
  function setupFullpage() {
    var slideCounter = 0;
    var slideMovements = 0;
    $('#fullpage').fullpage({
      anchors:['quotes','inspiration','passion','diy','search','pictures','settings','download'],
      controlArrows: false,
      fixedElements: ".header",
      afterRender: function() {
        $('#fullpage').fadeTo(1000, 1.0);
      },
      onSlideLeave: function(anchorLink, index, slideIndex, direction, nextSlideIndex) {
//         console.log("Leaving!");
        slideMovements++;
      }
    });
    var autoScroll = function() {
//       console.log("Slide movements: " + slideMovements);
//       console.log("Slide counter: " + slideCounter);
      if (slideMovements > slideCounter) {
        // The user scrolled manually
        return;
      } else if (++slideCounter > 4) {
        return;
      }
      var $activeSection = $("div.section.active");
      if ($activeSection.index() != 0) {
//         console.log("User scrolled down");
        return;
      }

      $.fn.fullpage.moveSlideRight();
      setTimeout(autoScroll, 3000);
    }
    setTimeout(autoScroll, 4000);

    var showDownArrow = function() {
      var $activeSection = $("div.section.active");
      if ($activeSection.index() != 0) {
//         console.log("User scrolled down already, not showing the arrow");
        return;
      }
      var counter = 0;
      var $downArrow = $("img.downArrow");
      animateArrow();
      function animateArrow() {
        if (++counter > 2) {
          $downArrow.animate({marginBottom: 0, opacity: 1.0}, 2000);
          return;
        }
        $downArrow.animate({marginBottom: 0, opacity: 1.0}, 2000);
        $downArrow.animate({marginBottom: 30, opacity: 0}, 2000, animateArrow);
      }
    }
    setTimeout(showDownArrow, 4000);
    var revealHeader = function() {
      $("div.header").fadeTo(1000, 1.0);
    }
    setTimeout(revealHeader, 1000);
  }
</script>